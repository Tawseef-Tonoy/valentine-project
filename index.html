<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Be My Valentine ðŸ’˜</title>
<style>
:root {
    --primary-pink: #ff85a2;
    --secondary-pink: #ffacc5;
    --dark-pink: #ff4d6d;
    --bg-gradient: linear-gradient(135deg, #fce4ec 0%, #ffc1e3 100%);
}

body {
    margin: 0;
    padding: 0;
    font-family: 'Poppins', sans-serif;
    background: var(--bg-gradient);
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
}

.floating-bg {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    pointer-events: none;
}

.card {
    background: rgba(255, 255, 255, 0.85);
    backdrop-filter: blur(15px);
    padding: 40px;
    border-radius: 30px;
    border: 4px solid #fff;
    box-shadow: 0 20px 40px rgba(255, 77, 109, 0.2);
    text-align: center;
    width: 450px; /* bigger playground */
    position: relative;
    transition: transform 0.3s ease;
    animation: floatCard 3s ease-in-out infinite;
}

@keyframes floatCard {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

h2 { color: var(--dark-pink); font-size: 26px; margin-bottom: 10px; }
p { color: #880e4f; margin-bottom: 20px; }

input {
    width: 80%;
    padding: 12px;
    margin: 10px 0;
    border: 2px solid var(--secondary-pink);
    border-radius: 15px;
    outline: none;
    transition: 0.3s;
}
input:focus { border-color: var(--dark-pink); }

button {
    padding: 12px 25px;
    border-radius: 50px;
    border: none;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

#generate { background: var(--dark-pink); color: white; font-size: 1rem; }
#copyLink { background: var(--secondary-pink); color: #fff; margin-left: 10px; }
#yes { background: var(--dark-pink); color: white; font-size: 1.2rem; }
#no { background: #fff; color: var(--dark-pink); border: 2px solid var(--dark-pink); position: absolute; }

.stats-footer {
    margin-top: 25px;
    font-size: 12px;
    color: #ad1457;
    display: flex;
    justify-content: space-around;
    border-top: 1px solid rgba(255, 77, 109, 0.2);
    padding-top: 15px;
}

.heart { position: absolute; animation: fly 4s linear forwards; z-index: 10; }
@keyframes fly { to { transform: translateY(-100vh) rotate(360deg); opacity: 0; } }

#linkBox { word-break: break-all; font-size: 12px; background: #fff; padding: 10px; border-radius: 10px; margin-top: 10px; display:flex; justify-content:space-between; align-items:center;}
</style>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>

<div class="floating-bg" id="bgLayer"></div>

<!-- Setup Card -->
<div class="card" id="setup">
    <h2>Valentine Maker ðŸŽ€</h2>
    <p>Create a link for your crush!</p>
    <input id="fromInput" placeholder="Your Name" />
    <input id="toInput" placeholder="Crush's Name" />
    <button id="generate" onclick="generateLink()">Create Magic âœ¨</button>
    <div id="linkBox" style="display:none;">
        <span id="linkText"></span>
        <button id="copyLink" onclick="copyLink()">Copy ðŸ”—</button>
    </div>
</div>

<!-- Game Card -->
<div class="card" id="game" style="display:none;">
    <h2 id="question"></h2>
    <p id="fromText"></p>

    <div style="height: 200px; display: flex; align-items: center; justify-content: center; position: relative;">
        <button id="yes">YES! ðŸ’˜</button>
        <button id="no">No ðŸ˜¢</button>
    </div>

    <div class="stats-footer">
        <div>ðŸ‘€ Views: <span id="viewCount">0</span></div>
        <div>ðŸ˜† Dodged: <span id="escCount">0</span></div>
    </div>
    <div id="message" style="margin-top: 15px; font-weight: 600; color: var(--dark-pink);"></div>
</div>

<!-- Funny Sound -->
<audio id="yaySound">
    <source src="https://www.soundjay.com/button/sounds/button-3.mp3" type="audio/mpeg">
</audio>

<script>
const params = new URLSearchParams(window.location.search);
const fromName = params.get("from");
const toName = params.get("to");

// Initialize view count
let views = parseInt(localStorage.getItem('v_count') || 0);
if(fromName){
    views++;
    localStorage.setItem('v_count', views);
    document.getElementById('setup').style.display='none';
    document.getElementById('game').style.display='block';
    document.getElementById('question').innerText = `${toName}, will you be my Valentine?`;
    document.getElementById('fromText').innerText = `With love from ${fromName}`;
    document.getElementById('viewCount').innerText = views;
}

// Generate Link
function generateLink(){
    const f = document.getElementById('fromInput').value;
    const t = document.getElementById('toInput').value;
    if(!f || !t) return alert("Please fill both names! â¤ï¸");
    const link = `${window.location.origin}${window.location.pathname}?from=${encodeURIComponent(f)}&to=${encodeURIComponent(t)}`;
    const box = document.getElementById('linkBox');
    box.style.display='flex';
    document.getElementById('linkText').innerText = link;
}

// Copy Link
function copyLink(){
    const linkText = document.getElementById('linkText').innerText;
    navigator.clipboard.writeText(linkText).then(()=>{
        alert("Link copied! ðŸ’˜");
    });
}

// Runaway No Button - smart for desktop + mobile
const noBtn = document.getElementById('no');
const yesBtn = document.getElementById('yes');
let escapes = 0;

// Detect mobile
const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);

function moveNo() {
    escapes++;
    document.getElementById('escCount').innerText = escapes;

    // Get card dimensions
    const cardRect = noBtn.parentElement.getBoundingClientRect();
    const x = Math.random() * (cardRect.width - noBtn.offsetWidth);
    const y = Math.random() * (cardRect.height - noBtn.offsetHeight);
    noBtn.style.transform = `translate(${x}px, ${y}px) scale(${Math.max(1 - escapes*0.1,0.4)})`;

    yesBtn.style.transform = `scale(${1 + escapes*0.15})`;

    // Fun emoji pop
    const e = document.createElement('div');
    e.className='heart';
    e.innerHTML=['ðŸ˜‚','ðŸ’”','ðŸ’¥','ðŸ˜†'][Math.floor(Math.random()*4)];
    e.style.left = Math.random()*80+'%';
    e.style.bottom='10px';
    e.style.fontSize=(Math.random()*20+20)+'px';
    document.body.appendChild(e);
    setTimeout(()=>e.remove(),1500);

    // After several escapes, No disappears
    if(escapes > 5){
        noBtn.style.opacity='0';
        setTimeout(()=>noBtn.remove(),300);
    }
}

// Desktop hover
if(!isMobile){
    noBtn.addEventListener('mouseover', moveNo);
}

// Mobile touch
if(isMobile){
    noBtn.addEventListener('touchstart', function(e){
        e.preventDefault(); // prevent immediate click
        moveNo();
    });
}

// YES Button
yesBtn.addEventListener('click', ()=>{
    const sound = document.getElementById('yaySound');
    sound.play();
    document.getElementById('message').innerHTML="ðŸŽ‰ YAY! Best Day Ever! ðŸ¥‚";
    yesBtn.style.display='none';
    if(document.getElementById('no')) noBtn.style.display='none';

    // Hearts Explosion
    for(let i=0;i<100;i++){
        setTimeout(createHeart,i*20);
    }
});

// Floating Hearts
function createHeart(){
    const h = document.createElement('div');
    h.className='heart';
    h.innerHTML=['â¤ï¸','ðŸ’–','ðŸŒ¸','âœ¨'][Math.floor(Math.random()*4)];
    h.style.left = Math.random()*100+'vw';
    h.style.bottom='-5%';
    h.style.fontSize=(Math.random()*20+20)+'px';
    document.body.appendChild(h);
    setTimeout(()=>h.remove(),4000);
}
setInterval(createHeart,800);
</script>
</body>
</html>
